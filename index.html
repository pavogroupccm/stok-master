<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pavo Group | Kurumsal Ä°letiÅŸim ERP</title>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root { 
            --primary: #4f46e5; --secondary: #64748b; --success: #22c55e; --danger: #ef4444; --warning: #f59e0b; --info: #0ea5e9;
            --bg: #f8fafc; --card-bg: #ffffff; --text-main: #1e293b; --border: #e2e8f0; --input-bg: #f1f5f9; 
        }
        [data-theme="dark"] {
            --bg: #0f172a; --card-bg: #1e293b; --text-main: #f1f5f9;
            --border: #334155; --input-bg: #334155; --secondary: #94a3b8;
        }
        body { font-family: 'Inter', sans-serif; background-color: var(--bg); color: var(--text-main); margin: 0; height: 100vh; overflow: hidden; }

        /* LOGIN */
        #login-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--bg); z-index: 999; display: flex; justify-content: center; align-items: center; }
        .login-card { background: var(--card-bg); padding: 40px; border-radius: 16px; border: 1px solid var(--border); width: 100%; max-width: 400px; text-align: center; }
        .login-logo { width: 180px; margin-bottom: 20px; filter: invert(0); }
        [data-theme="dark"] .login-logo { filter: invert(1); }
        .login-input { margin-bottom: 15px; padding: 12px; width: 100%; border: 1px solid var(--border); border-radius: 8px; background: var(--input-bg); color: var(--text-main); box-sizing: border-box; }

        /* LAYOUT */
        #app-screen { display: none; height: 100vh; width: 100%; }
        .wrapper { display: flex; height: 100%; width: 100%; }
        .sidebar { width: 260px; background: #1e293b; height: 100%; color: white; padding: 20px; display: flex; flex-direction: column; flex-shrink: 0; overflow-y: auto; }
        .brand-logo { width: 100%; max-width: 150px; margin-bottom: 20px; filter: brightness(0) invert(1); }
        
        .nav-group { margin-bottom: 15px; }
        .nav-label { font-size: 0.7rem; text-transform: uppercase; color: #64748b; margin-bottom: 5px; font-weight: bold; letter-spacing: 0.5px; }
        .nav-btn { width: 100%; background: transparent; color: #cbd5e1; padding: 10px; border-radius: 8px; margin-bottom: 2px; cursor: pointer; border: none; text-align: left; font-weight: 500; display: flex; align-items: center; gap: 10px; transition: 0.2s; font-size: 0.9rem; }
        .nav-btn.active { background: var(--primary); color: white; }
        .nav-btn:hover:not(.active) { background: #334155; color: white; }

        .main-container { flex-grow: 1; overflow-y: auto; padding: 25px; position: relative; }
        .page { display: none; animation: fadeIn 0.3s ease; }
        .page.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* COMPONENTS */
        .card { background: var(--card-bg); padding: 25px; border-radius: 16px; border: 1px solid var(--border); margin-bottom: 20px; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px; }
        .stat-card { background: var(--card-bg); padding: 15px; border-radius: 12px; border: 1px solid var(--border); }
        .form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 10px; }
        input, select, textarea { background: var(--input-bg); color: var(--text-main); padding: 10px; border: 1px solid var(--border); border-radius: 8px; font-size: 0.85rem; width: 100%; box-sizing: border-box; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th { text-align: left; padding: 10px; color: var(--secondary); border-bottom: 2px solid var(--border); font-size: 0.75rem; }
        td { padding: 12px 10px; border-bottom: 1px solid var(--border); font-size: 0.85rem; }
        .btn { padding: 8px 16px; border-radius: 6px; border: none; cursor: pointer; font-weight: 600; font-size: 0.85rem; }
        .btn-primary { background: var(--primary); color: white; }
        .btn-danger { background: var(--danger); color: white; }
        .btn-action { padding: 5px 8px; margin-left: 2px; border-radius: 4px; border: none; color: white; cursor: pointer; }
        
        .tag { padding: 3px 8px; border-radius: 10px; font-size: 0.7rem; font-weight: 600; }
        .tag-pos { background: #dcfce7; color: #166534; }
        .tag-neu { background: #f1f5f9; color: #475569; }
        .tag-neg { background: #fee2e2; color: #991b1b; }

        /* ROBOT STYLES */
        .robot-results { display: grid; grid-template-columns: 1fr; gap: 10px; max-height: 300px; overflow-y: auto; margin-top: 15px; }
        .robot-item { padding: 10px; border: 1px solid var(--border); border-radius: 8px; display: flex; justify-content: space-between; align-items: center; background: var(--input-bg); }
        .robot-info h4 { margin: 0 0 5px 0; font-size: 0.9rem; }
        .robot-info p { margin: 0; font-size: 0.75rem; color: var(--secondary); }
    </style>
</head>
<body data-theme="light">

    <div id="login-screen">
        <div class="login-card">
            <img src="https://www.pavo-group.com/wp-content/uploads/2024/sign/img/logo.png" class="login-logo">
            <h3>Kurumsal Ä°letiÅŸim ERP</h3>
            <input type="email" id="email" class="login-input" placeholder="E-posta">
            <input type="password" id="password" class="login-input" placeholder="Åifre">
            <button class="btn btn-primary" style="width:100%" onclick="login()">GiriÅŸ Yap</button>
            <p id="login-error" style="color:red; font-size:0.8rem; margin-top:10px;"></p>
        </div>
    </div>

    <div id="app-screen">
        <div class="wrapper">
            <div class="sidebar">
                <img src="https://www.pavo-group.com/wp-content/uploads/2024/sign/img/logo.png" class="brand-logo">
                
                <div class="nav-group">
                    <div class="nav-label">Genel</div>
                    <button class="nav-btn active" onclick="showPage('dashboard-page', this)">ğŸ“Š Dashboard</button>
                    <button class="nav-btn" onclick="showPage('log-page', this)">ğŸ•’ Ä°ÅŸlem LoglarÄ±</button>
                </div>

                <div class="nav-group">
                    <div class="nav-label">Operasyon</div>
                    <button class="nav-btn" onclick="showPage('stok-page', this)">ğŸ“¦ Promosyon Stok</button>
                    <button class="nav-btn" onclick="showPage('fuar-page', this)">ğŸŸï¸ Fuar & Etkinlik</button>
                </div>

                <div class="nav-group">
                    <div class="nav-label">Ä°letiÅŸim & PR</div>
                    <button class="nav-btn" onclick="showPage('media-page', this)">ğŸ‘¥ Medya Ä°liÅŸkileri</button>
                    <button class="nav-btn" onclick="showPage('press-page', this)">ğŸ“° BasÄ±n YansÄ±malarÄ±</button>
                    <button class="nav-btn" onclick="showPage('content-page', this)">ğŸ“… Ä°Ã§erik Takvimi</button>
                    <button class="nav-btn" onclick="showPage('supplier-page', this)">ğŸ¤ TedarikÃ§i Havuzu</button>
                </div>
                
                <div style="margin-top:auto; padding-top:15px; border-top:1px solid #334155;">
                    <button class="nav-btn" onclick="toggleTheme()"><small>ğŸŒ“ Gece/GÃ¼ndÃ¼z</small></button>
                    <button class="nav-btn" onclick="logout()" style="color:var(--danger)"><small>ğŸšª Ã‡Ä±kÄ±ÅŸ</small></button>
                </div>
            </div>

            <div class="main-container">

                <div id="dashboard-page" class="page active">
                    <h2 style="margin-bottom:20px">YÃ¶netim Ã–zeti</h2>
                    <div class="stats-grid">
                        <div class="stat-card"><small>Toplam Stok DeÄŸeri</small><h2 id="d-stock">0</h2></div>
                        <div class="stat-card"><small>Fuar BÃ¼tÃ§esi</small><h2 id="d-fair" style="color:var(--success)">$0</h2></div>
                        <div class="stat-card"><small>Medya VeritabanÄ±</small><h2 id="d-media">0 KiÅŸi</h2></div>
                        <div class="stat-card"><small>Haber YansÄ±masÄ±</small><h2 id="d-press">0 Adet</h2></div>
                    </div>
                    <div style="display:grid; grid-template-columns:1fr 1fr; gap:20px">
                        <div class="card"><h3>Stok DaÄŸÄ±lÄ±mÄ±</h3><canvas id="chart1"></canvas></div>
                        <div class="card"><h3>Ä°letiÅŸim KanallarÄ±</h3><canvas id="chart2"></canvas></div>
                    </div>
                </div>

                <div id="stok-page" class="page">
                    <div class="card">
                        <h3>ÃœrÃ¼n Ekle</h3>
                        <div class="form-grid">
                            <input type="text" id="pName" placeholder="ÃœrÃ¼n AdÄ±">
                            <select id="pCat"><option>BasÄ±lÄ±</option><option>Promosyon</option><option>DemirbaÅŸ</option></select>
                            <select id="pWh"><option>Ankara</option><option>Ä°stanbul</option></select>
                            <input type="number" id="pQty" placeholder="Miktar">
                            <button class="btn btn-primary" onclick="addProduct()">Kaydet</button>
                        </div>
                    </div>
                    <div class="card">
                        <input type="text" id="searchStock" onkeyup="updateStockUI()" placeholder="ğŸ” Stok Ara..." style="margin-bottom:10px">
                        <table>
                            <thead><tr><th>ÃœrÃ¼n</th><th>Depo</th><th>Adet</th><th>Ä°ÅŸlem</th></tr></thead>
                            <tbody id="stockBody"></tbody>
                        </table>
                    </div>
                </div>

                <div id="fuar-page" class="page">
                    <div class="card">
                        <h3>Yeni Fuar</h3>
                        <div class="form-grid">
                            <input type="text" id="fName" placeholder="Fuar AdÄ±">
                            <input type="date" id="fDate">
                            <input type="number" id="fCost" placeholder="Toplam BÃ¼tÃ§e ($)">
                            <button class="btn btn-primary" onclick="addFair()">Planla</button>
                        </div>
                    </div>
                    <div class="card">
                        <table><thead><tr><th>Fuar</th><th>Tarih</th><th>BÃ¼tÃ§e</th><th>Ä°ÅŸlem</th></tr></thead><tbody id="fairBody"></tbody></table>
                    </div>
                </div>

                <div id="media-page" class="page">
                    <div class="card">
                        <h3>Yeni Gazeteci / EditÃ¶r</h3>
                        <div class="form-grid">
                            <input type="text" id="mName" placeholder="Ad Soyad">
                            <input type="text" id="mOutlet" placeholder="Kurum (Ã–rn: HÃ¼rriyet)">
                            <input type="text" id="mRole" placeholder="GÃ¶revi (Ã–rn: EditÃ¶r)">
                            <input type="text" id="mEmail" placeholder="E-posta">
                            <input type="text" id="mPhone" placeholder="Telefon">
                            <button class="btn btn-primary" onclick="addMedia()">Kaydet</button>
                        </div>
                    </div>
                    <div class="card">
                        <h3>Medya VeritabanÄ±</h3>
                        <table><thead><tr><th>Ä°sim / GÃ¶rev</th><th>Kurum</th><th>Ä°letiÅŸim</th><th>Ä°ÅŸlem</th></tr></thead><tbody id="mediaBody"></tbody></table>
                    </div>
                </div>

                <div id="press-page" class="page">
                    
                    <div class="card" style="border-left: 5px solid var(--info);">
                        <h3>ğŸ¤– Otomatik Medya Tarama Robotu</h3>
                        <p style="font-size:0.8rem; color:var(--secondary)">Pavo Group ile ilgili son haberleri tarayÄ±n (Google News/GNews)</p>
                        <div style="display:flex; gap:10px; margin-top:10px;">
                            <input type="text" id="robotApiKey" value="d61c9a050f8b83e3ce29ad4223fed75b" placeholder="API Key" style="flex:1">
                            <input type="text" id="robotKeyword" value="Pavo Group" placeholder="Anahtar Kelime" style="flex:1">
                            <button class="btn btn-primary" onclick="fetchNews()">ğŸ” Ä°nterneti Tara</button>
                        </div>
                        <div id="robotResults" class="robot-results"></div>
                    </div>

                    <div class="card">
                        <h3>Haber ArÅŸivi (Manuel GiriÅŸ)</h3>
                        <div class="form-grid">
                            <input type="text" id="prTitle" placeholder="Haber BaÅŸlÄ±ÄŸÄ±">
                            <input type="text" id="prOutlet" placeholder="Mecra (Ã–rn: Webrazzi)">
                            <input type="date" id="prDate">
                            <select id="prSentiment"><option value="Pozitif">Pozitif ğŸ˜Š</option><option value="NÃ¶tr">NÃ¶tr ğŸ˜</option><option value="Negatif">Negatif â˜¹ï¸</option></select>
                            <input type="text" id="prLink" placeholder="Haber Linki">
                            <button class="btn btn-primary" onclick="addPress()">ArÅŸive Ekle</button>
                        </div>
                    </div>
                    <div class="card">
                        <table><thead><tr><th>Tarih</th><th>BaÅŸlÄ±k / Mecra</th><th>Durum</th><th>Link</th><th>Ä°ÅŸlem</th></tr></thead><tbody id="pressBody"></tbody></table>
                    </div>
                </div>

                <div id="content-page" class="page">
                    <div class="card">
                        <h3>Ä°Ã§erik Planla</h3>
                        <div class="form-grid">
                            <input type="date" id="cDate">
                            <select id="cPlatform"><option>LinkedIn</option><option>Twitter/X</option><option>Instagram</option><option>Web Sitesi</option></select>
                            <input type="text" id="cTitle" placeholder="Konu / BaÅŸlÄ±k">
                            <select id="cStatus"><option>Taslak</option><option>Onay Bekliyor</option><option>YayÄ±nda</option></select>
                            <button class="btn btn-primary" onclick="addContent()">Planla</button>
                        </div>
                    </div>
                    <div class="card">
                        <table><thead><tr><th>Tarih</th><th>Platform</th><th>Ä°Ã§erik</th><th>Durum</th><th>Ä°ÅŸlem</th></tr></thead><tbody id="contentBody"></tbody></table>
                    </div>
                </div>

                <div id="supplier-page" class="page">
                    <div class="card">
                        <h3>Yeni TedarikÃ§i</h3>
                        <div class="form-grid">
                            <input type="text" id="sName" placeholder="Firma AdÄ±">
                            <select id="sType"><option>Ajans (PR)</option><option>Kreatif</option><option>Matbaa</option><option>ProdÃ¼ksiyon</option><option>Lojistik</option></select>
                            <input type="text" id="sContact" placeholder="Yetkili KiÅŸi">
                            <input type="text" id="sPhone" placeholder="Telefon / Email">
                            <button class="btn btn-primary" onclick="addSupplier()">Ekle</button>
                        </div>
                    </div>
                    <div class="card">
                        <table><thead><tr><th>Firma</th><th>Hizmet</th><th>Ä°letiÅŸim</th><th>Ä°ÅŸlem</th></tr></thead><tbody id="supplierBody"></tbody></table>
                    </div>
                </div>

                <div id="log-page" class="page">
                    <div class="card">
                        <h3>Ä°ÅŸlem LoglarÄ±</h3>
                        <div style="max-height:500px;overflow-y:auto">
                            <table><thead><tr><th>Zaman</th><th>KullanÄ±cÄ±</th><th>Ä°ÅŸlem</th></tr></thead><tbody id="logBody"></tbody></table>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

<script>
    const firebaseConfig = {
      apiKey: "AIzaSyAfvTWPkPVQ63T_fTHiYMRnerHkdgqbTr4",
      authDomain: "stokmasterbulut.firebaseapp.com",
      databaseURL: "https://stokmasterbulut-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "stokmasterbulut",
      storageBucket: "stokmasterbulut.firebasestorage.app",
      messagingSenderId: "623117556073",
      appId: "1:623117556073:web:b082fb0567879ac71d45f8"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const auth = firebase.auth();

    let currentUser = null;
    let stock=[], fairs=[], media=[], press=[], content=[], suppliers=[], logs=[];

    auth.onAuthStateChanged(user => {
        if(user){
            currentUser=user;
            document.getElementById('login-screen').style.display='none';
            document.getElementById('app-screen').style.display='block';
            initApp();
        } else {
            document.getElementById('login-screen').style.display='flex';
            document.getElementById('app-screen').style.display='none';
        }
    });

    function login(){
        const e=document.getElementById('email').value;
        const p=document.getElementById('password').value;
        auth.signInWithEmailAndPassword(e,p).catch(err=>alert("GiriÅŸ baÅŸarÄ±sÄ±z!"));
    }
    function logout(){ auth.signOut(); }

    function initApp(){
        const refs = ['inventory','fairs','media','press','content','suppliers','logs'];
        refs.forEach(r => {
            db.ref(r).on('value', snap => {
                const val = snap.val();
                const list = val ? Object.values(val) : [];
                if(r==='inventory') { stock=list; updateStockUI(); }
                if(r==='fairs') { fairs=list; updateFairUI(); }
                if(r==='media') { media=list; updateMediaUI(); }
                if(r==='press') { press=list; updatePressUI(); }
                if(r==='content') { content=list; updateContentUI(); }
                if(r==='suppliers') { suppliers=list; updateSupplierUI(); }
                if(r==='logs') { logs=list; updateLogUI(); }
                updateDashboard();
            });
        });
    }

    // --- ROBOT FONKSÄ°YONU ---
    async function fetchNews() {
        const key = document.getElementById('robotApiKey').value;
        const query = document.getElementById('robotKeyword').value;
        const container = document.getElementById('robotResults');
        
        if(!key || !query) return alert("LÃ¼tfen API Key ve Anahtar Kelime giriniz.");
        
        container.innerHTML = '<div style="padding:10px; text-align:center">TaranÄ±yor...</div>';

        try {
            const url = `https://gnews.io/api/v4/search?q=${encodeURIComponent(query)}&lang=tr&max=5&token=${key}`;
            const response = await fetch(url);
            const data = await response.json();

            container.innerHTML = '';
            
            if(!data.articles || data.articles.length === 0) {
                container.innerHTML = '<div style="padding:10px">Haber bulunamadÄ±.</div>';
                return;
            }

            data.articles.forEach(news => {
                const div = document.createElement('div');
                div.className = 'robot-item';
                // GÃ¼venli HTML yapÄ±sÄ±
                div.innerHTML = `
                    <div class="robot-info">
                        <h4>${news.title}</h4>
                        <p>${news.source.name} - ${new Date(news.publishedAt).toLocaleDateString('tr-TR')}</p>
                        <a href="${news.url}" target="_blank" style="font-size:0.7rem;">Habere Git</a>
                    </div>
                    <button class="btn-action" style="background:var(--success)" onclick="saveRobotNews('${encodeURIComponent(news.title)}', '${encodeURIComponent(news.source.name)}', '${news.url}')">Ekle</button>
                `;
                container.appendChild(div);
            });

        } catch (error) {
            console.error(error);
            container.innerHTML = '<div style="color:red; padding:10px">Hata oluÅŸtu. GÃ¼nlÃ¼k kota dolmuÅŸ olabilir.</div>';
        }
    }

    function saveRobotNews(title, source, url) {
        const t = decodeURIComponent(title);
        const s = decodeURIComponent(source);
        const id = Date.now();
        db.ref('press/'+id).set({
            id, title: t, outlet: s, date: new Date().toISOString().split('T')[0], sent: 'NÃ¶tr', link: url
        });
        log("Robot: " + t);
        alert("Haber baÅŸarÄ±yla kaydedildi!");
    }

    // --- UI UPDATERS ---
    function updateDashboard(){
        document.getElementById('d-stock').innerText = stock.reduce((a,b)=>a+b.qty,0);
        let fairBud = fairs.reduce((a,b)=>a+parseFloat(b.cost||0),0);
        document.getElementById('d-fair').innerText = "$ " + fairBud.toLocaleString();
        document.getElementById('d-media').innerText = media.length + " KiÅŸi";
        document.getElementById('d-press').innerText = press.length + " Adet";

        if(window.myChart1) window.myChart1.destroy();
        window.myChart1 = new Chart(document.getElementById('chart1'), {
            type: 'doughnut',
            data: { labels: ['Ankara','Ä°stanbul'], datasets: [{data:[stock.filter(i=>i.wh=='Ankara').length, stock.filter(i=>i.wh=='Ä°stanbul').length], backgroundColor:['#f97316','#0ea5e9']}] }
        });

        if(window.myChart2) window.myChart2.destroy();
        window.myChart2 = new Chart(document.getElementById('chart2'), {
            type: 'bar',
            data: { labels: ['BasÄ±n', 'LinkedIn', 'Twitter'], datasets: [{label:'Adet', data:[press.length, content.filter(c=>c.plat=='LinkedIn').length, content.filter(c=>c.plat=='Twitter/X').length], backgroundColor:'#6366f1'}] }
        });
    }

    function updateStockUI(){
        let html=''; const term = document.getElementById('searchStock').value.toLowerCase();
        stock.forEach(i=>{
            if(i.name.toLowerCase().includes(term))
            html+=`<tr><td><b>${i.name}</b><br><small>${i.cat}</small></td><td>${i.wh}</td><td>${i.qty}</td>
            <td><button class="btn-action" style="background:var(--success)" onclick="modStock('${i.id}',1)">+</button>
            <button class="btn-action" style="background:var(--danger)" onclick="modStock('${i.id}',-1)">-</button>
            <button class="btn-action" style="background:#64748b" onclick="del('inventory','${i.id}')">ğŸ—‘ï¸</button></td></tr>`;
        });
        document.getElementById('stockBody').innerHTML=html;
    }
    function updateFairUI(){
        let html=''; fairs.forEach(f=>{ html+=`<tr><td><b>${f.name}</b></td><td>${f.date}</td><td>$ ${parseFloat(f.cost).toLocaleString()}</td><td><button class="btn-action" style="background:var(--danger)" onclick="del('fairs','${f.id}')">ğŸ—‘ï¸</button></td></tr>`; }); document.getElementById('fairBody').innerHTML=html;
    }
    function updateMediaUI(){
        let html=''; media.forEach(m=>{ html+=`<tr><td><b>${m.name}</b><br><small>${m.role}</small></td><td>${m.outlet}</td><td><small>${m.email}</small></td><td><button class="btn-action" style="background:var(--danger)" onclick="del('media','${m.id}')">ğŸ—‘ï¸</button></td></tr>`; }); document.getElementById('mediaBody').innerHTML=html;
    }
    function updatePressUI(){
        let html=''; press.forEach(p=>{ let b=p.sent==='Pozitif'?'tag-pos':(p.sent==='Negatif'?'tag-neg':'tag-neu'); html+=`<tr><td><small>${p.date}</small></td><td><b>${p.title}</b><br><small>${p.outlet}</small></td><td><span class="tag ${b}">${p.sent}</span></td><td><a href="${p.link}" target="_blank">ğŸ”—</a></td><td><button class="btn-action" style="background:var(--danger)" onclick="del('press','${p.id}')">ğŸ—‘ï¸</button></td></tr>`; }); document.getElementById('pressBody').innerHTML=html;
    }
    function updateContentUI(){
        let html=''; content.forEach(c=>{ let k=c.status==='YayÄ±nda'?'#22c55e':(c.status==='Taslak'?'#64748b':'#f59e0b'); html+=`<tr><td><small>${c.date}</small></td><td>${c.plat}</td><td>${c.title}</td><td><span style="color:${k};font-weight:bold">${c.status}</span></td><td><button class="btn-action" style="background:var(--danger)" onclick="del('content','${c.id}')">ğŸ—‘ï¸</button></td></tr>`; }); document.getElementById('contentBody').innerHTML=html;
    }
    function updateSupplierUI(){
        let html=''; suppliers.forEach(s=>{ html+=`<tr><td><b>${s.name}</b></td><td>${s.type}</td><td>${s.contact}<br><small>${s.phone}</small></td><td><button class="btn-action" style="background:var(--danger)" onclick="del('suppliers','${s.id}')">ğŸ—‘ï¸</button></td></tr>`; }); document.getElementById('supplierBody').innerHTML=html;
    }
    function updateLogUI(){
        let html=''; [...logs].reverse().forEach(l=>{ html+=`<tr><td><small>${l.time}</small></td><td><small>${l.user}</small></td><td>${l.action}</td></tr>`; }); document.getElementById('logBody').innerHTML=html;
    }

    // ACTIONS
    function addProduct(){ const id=Date.now(); db.ref('inventory/'+id).set({id, name:v('pName'), cat:v('pCat'), wh:v('pWh'), qty:parseInt(v('pQty'))||0}); log("ÃœrÃ¼n Eklendi: "+v('pName')); clear(['pName','pQty']); }
    function modStock(id, n){ const i=stock.find(x=>x.id==id); db.ref('inventory/'+id).update({qty:i.qty+n}); log("Stok GÃ¼ncelleme"); }
    function addFair(){ const id=Date.now(); db.ref('fairs/'+id).set({id, name:v('fName'), date:v('fDate'), cost:v('fCost')}); log("Fuar Eklendi"); clear(['fName','fCost']); }
    function addMedia(){ const id=Date.now(); db.ref('media/'+id).set({id, name:v('mName'), outlet:v('mOutlet'), role:v('mRole'), email:v('mEmail'), phone:v('mPhone')}); log("Medya Eklendi"); clear(['mName','mOutlet','mRole','mEmail','mPhone']); }
    function addPress(){ const id=Date.now(); db.ref('press/'+id).set({id, title:v('prTitle'), outlet:v('prOutlet'), date:v('prDate'), sent:v('prSentiment'), link:v('prLink')}); log("Haber Eklendi"); clear(['prTitle','prOutlet','prLink']); }
    function addContent(){ const id=Date.now(); db.ref('content/'+id).set({id, date:v('cDate'), plat:v('cPlatform'), title:v('cTitle'), status:v('cStatus')}); log("Ä°Ã§erik PlanlandÄ±"); clear(['cTitle']); }
    function addSupplier(){ const id=Date.now(); db.ref('suppliers/'+id).set({id, name:v('sName'), type:v('sType'), contact:v('sContact'), phone:v('sPhone')}); log("TedarikÃ§i Eklendi"); clear(['sName','sContact','sPhone']); }

    function v(id){ return document.getElementById(id).value; }
    function clear(ids){ ids.forEach(id=>document.getElementById(id).value=''); }
    function del(path, id){ if(confirm('Silinsin mi?')) db.ref(path+'/'+id).remove(); log(path+" Silindi"); }
    function log(act){ db.ref('logs/'+Date.now()).set({time:new Date().toLocaleString('tr-TR'), user:currentUser.email, action:act}); }
    
    function showPage(pid, btn){
        document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
        document.querySelectorAll('.nav-btn').forEach(b=>b.classList.remove('active'));
        document.getElementById(pid).classList.add('active');
        btn.classList.add('active');
    }
    function toggleTheme(){ const t=document.body.getAttribute('data-theme')=='dark'?'light':'dark'; document.body.setAttribute('data-theme',t); }
</script>
</body>
</html>
